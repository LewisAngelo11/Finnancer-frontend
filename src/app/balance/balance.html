<main class="w-screen h-screen text-white p-4 flex flex-col items-center">
    <div class="w-full lg:w-4/5 flex items-start">
        <button
            (click)="goToDashboard()"
            class="bg-green-primary flex items-center justify-center rounded-full w-10 h-auto p-2 mb-4 ml-2"
        >
            <i class='bx  bx-chevron-left text-2xl text-black'  ></i> 
        </button>
    </div>

    <div class="flex flex-col justify-start gap-3 w-full lg:w-4/5">
        <div>
            <h2 class="text-xl lg:text-3xl">Balance Simplificado</h2>
            <p class="text-lg text-[#727272] font-thin">Balance mensual del mes: {{mesActual}}</p>
        </div>

        <form [formGroup]="formBalance" (ngSubmit)="consultarBalance()">
            <div class="flex flex-row gap-2 lg:gap-6">

                <!-- Select Mes -->
                <select
                    class="card w-full p-3 border-1 border-white rounded-xl md:rounded-2xl text-gray-500"
                    formControlName="mes">
                    <option value="" disabled selected>Seleccione mes</option>
                    @for (mes of meses; track mes.value) {
                        <option [value]="mes.value">{{ mes.label }}</option>
                    }
                </select>

                <!-- Select Año -->
                <select
                    class="card w-full p-3 border border-white rounded-xl md:rounded-2xl text-gray-500"
                    formControlName="anio">
                    <option value="" disabled selected>Seleccione año</option>
                    @for (anio of anios; track $index) {
                        <option [value]="anio">{{ anio }}</option>
                    }
                </select>

                <button
                    type="submit"
                    class="card text-black bg-green-primary p-3 rounded-2xl w-full font-medium">
                    Consultar
                </button>

            </div>
        </form>

        <!-- Sección de ingresos -->
        <section class="bg-gradient-gray-h w-full rounded-2xl flex flex-col gap-2 lg:gap-4 p-4 lg:p-8 lg:min-h-[200px]">
            <h2 class="text-xl lg:text-3xl">Ingresos</h2>
            <!-- Línea divisora -->
            <span class="block bg-gray-details w-full h-0.5"></span>

            <ul class="w-full flex flex-col gap-2">
                @for (categoria of categoriasIngresos; track categoria.id_categoria) {
                    <li class="w-full flex flex-col gap-2">

                        <!-- Categoría -->
                        <div class="w-full flex flex-row text-base lg:text-xl justify-between items-center font-normal">
                            <p>{{ categoria.nombre }}</p>
                            <p class="font-thin">${{ categoria.monto_total }}</p>
                        </div>

                        <!-- Subcategorías -->
                        <ul class="w-full flex flex-col gap-1 pl-4 border-l-2 border-gray-400">
                            @for (subcategoria of categoria.subcategorias; track subcategoria.id_subcategoria) {
                                <li class="w-full flex flex-row justify-between text-sm lg:text-base text-gray-500">
                                    <p>{{ subcategoria.nombre }}</p>
                                    <p class="font-thin">${{ subcategoria.monto }}</p>
                                </li>
                            }
                        </ul>

                    </li>
                }
                @empty {
                    <p class="font-thin">No hay datos para este periodo</p>
                }
            </ul>
            <!-- Línea divisora -->
            <span class="block bg-gray-details w-full h-0.5"></span>

            <div class="w-full flex flex-row justify-between text-lg lg:text-2xl">
                <p>Ingresos Totales: </p>
                <p class="font-thin text-[#46E24D]">${{totalIngresos}}</p>
            </div>
        </section>

        <section class="bg-gradient-gray-h w-full rounded-2xl flex flex-col gap-2 lg:gap-4 p-4 lg:p-8 lg:min-h-[200px]">
            <h2 class="text-xl lg:text-3xl">Egresos</h2>
            <!-- Línea divisora -->
            <span class="block bg-gray-details w-full h-0.5"></span>

            <ul class="w-full flex flex-col gap-2">
                @for (categoria of categoriasEgresos; track categoria.id_categoria) {
                    <li class="w-full flex flex-col gap-2">

                        <!-- Categoría -->
                        <div class="w-full flex flex-row text-base lg:text-xl justify-between items-center font-normal">
                            <p>{{ categoria.nombre }}</p>
                            <p class="font-thin">${{ categoria.monto_total }}</p>
                        </div>

                        <!-- Subcategorías -->
                        <ul class="w-full flex flex-col gap-1 pl-4 border-l-2 border-gray-400">
                            @for (subcategoria of categoria.subcategorias; track subcategoria.id_subcategoria) {
                                <li class="w-full flex flex-row justify-between text-sm lg:text-base text-gray-500">
                                    <p>{{ subcategoria.nombre }}</p>
                                    <p class="font-thin">${{ subcategoria.monto }}</p>
                                </li>
                            }
                        </ul>

                    </li>
                }
                @empty {
                    <p class="font-thin">No hay datos para este periodo</p>
                }
            </ul>
            <!-- Línea divisora -->
            <span class="block bg-gray-details w-full h-0.5"></span>
            
            <div class="w-full flex flex-row justify-between text-lg lg:text-2xl">
                <p>Egresos Totales: </p>
                <p class="font-thin text-[#46E24D]">${{totalEgresos}}</p>
            </div>
        </section>
        
        <section class="bg-white rounded-2xl flex flex-col text-black gap-2 p-4 lg:p-8 lg:min-h-[200px]">
            <h2 class="text-xl lg:text-3xl">Balance</h2>
            <!-- Línea divisora -->
            <span class="bg-gray-200 w-full h-0.5"></span>
            <ul class="w-full flex flex-col">
                <li class="w-full flex flex-row items-center justify-between text-lg lg:text-2xl">
                    <p>Ingresos Totales</p>
                    <p class="font-light text-[#00C40A]">${{totalIngresos}}</p>
                </li>
            </ul>
            <ul class="w-full flex flex-col">
                <li class="w-full flex flex-row items-center justify-between text-lg lg:text-2xl">
                    <p>Egresos Totales</p>
                    <p class="font-light text-red-500">${{totalEgresos}}</p>
                </li>
            </ul>
            <!-- Línea divisora -->
            <span class="bg-gray-200 w-full h-0.5"></span>
            <div class="w-full flex flex-row items-center justify-between text-lg lg:text-2xl">
                <p>Resultado Neto</p>
                @if(resultadoNeto > 0) {
                    <p class="font-light text-[#00C40A]">${{resultadoNeto}}</p>
                }
                @else if (resultadoNeto < 0) {
                    <p class="font-light text-red-500">${{resultadoNeto}}</p>
                }
                @else {
                    <p class="font-ligh">${{resultadoNeto}}</p>
                }
            </div>
            <div class="w-full flex items-center justify-center">
                <button class="card bg-green-primary p-3 rounded-2xl lg:w-3/5 font-medium">
                    Imprimir Balance
                </button>
            </div>
        </section>
    </div>
</main>
